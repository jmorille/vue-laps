version: "3.8"
services:

  laps:
#    image: local/vue-laps:latest
    image: ghcr.io/jmorille/vue-laps:master
    container_name: laps
    restart: always
    user: '33:33'
    ports:
      - "80:80"
    environment:
      HTTPD_SERVER_NAME: "laps.localhost"
      HTTPD_SERVER_ALIAS: "127.0.0.1 localhost"
      KEYCLOAK_DOMAIN: "keycloak.home.loc:8443"
      KEYCLOAK_CLIENT_SECRET: "M1ogV3dCwDUKkqOKZBEVxEUuSlbX1wu5"
      APACHE_POWERSHELL_HOST: "powershell"
      APACHE_POWERSHELL_PORT: "8000"
    volumes:
      - "./logs/httpd-vuelaps:/var/log/httpd/vuelaps/"
#      - "./src/config/apache/socle/socle-logformat.conf:/DATA/vuelaps/conf-apache/socle/socle-logformat.conf"
#      - "./src/config/apache/keycloak-server.conf:/DATA/vuelaps/conf-apache/keycloak-server.conf"
      - "./src/config/apache/keycloak-location.conf:/DATA/vuelaps/conf-apache/keycloak-location.conf"
#      - "./src/config/apache/app-cgi.conf:/DATA/vuelaps/conf-apache/app-cgi.conf"
#      - "./src/config/cgi-bin/password.sh:/DATA/vuelaps/htdocs/cgi-bin/password.sh"
#      - "./src/config/cgi-bin/password.sh:/DATA/vuelaps/htdocs/cgi-bin/password.ps1"
    networks:
      - app-network

  powershell:
    build:
      dockerfile: ./powershell.Dockerfile
    container_name: powershell
    ports:
      - "8000:8000"
    networks:
      - app-network


#  php-fpm:
#    image: php:fpm
#    container_name: php-fpm
#    volumes:
#      - "./public:/DATA/vuelaps/htdocs/ihm"
#    networks:
#      - app-network

networks:
  app-network:
    driver: bridge
